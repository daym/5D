#ifndef __GTKREPL_H
#define __GTKREPL_H
/*
4D vector analysis program
Copyright (C) 2011  Danny Milosavljevic
This program is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.
This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more details.
You should have received a copy of the GNU General Public License along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
#include "AST/AST"
#include <gtk/gtk.h>
struct Config;
namespace GUI {
class GTKREPL {
private:
	GtkWindow* fWidget;
	GtkBox* fMainBox;
	GtkTextView* fOutputArea;
	GtkScrolledWindow* fOutputScroller;
	GtkTextBuffer* fOutputBuffer;
	GtkEntry* fCommandEntry;
	//GtkButton* fExecuteButton;
	//GtkBox* fShortcutBox;
	GtkTreeView* fEnvironmentView;
	GtkListStore* fEnvironmentStore;
	GHashTable* fEnvironmentKeys;
	GtkBox* fEditorBox;
	GtkScrolledWindow* fEnvironmentScroller;
	GtkFileChooser* fSaveDialog;
	GtkFileChooser* fOpenDialog;
	struct Config* fConfig;
protected:
	void handle_response(gint response_id, GtkDialog* dialog);
	void execute(const char* command, GtkTextIter* destination);
	void add_to_environment(AST::Node* definition);
	void set_current_environment_name(const char* absolute_name);
public:
	void save(void);
	void load(void);
	bool save_content_to(FILE* output_file);
	bool load_contents_from(const char* name);
	GTKREPL(GtkWindow* parent);
	GtkWidget* widget(void) const;
};

}; // end namespace GUI
#endif /* ndef __GTKREPL_H */
